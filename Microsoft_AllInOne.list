# Microsoft_AllInOne.list
# Purpose : Single-file Microsoft RULE-SET for Surge (self-maintained)
# Updated : 2025-09-06

##########
# NCSI / Connectivity probes（避免“已连接但无网络”）
##########
DOMAIN-SUFFIX,msftconnecttest.com
DOMAIN-SUFFIX,msftncsi.com
DOMAIN,dns.msftncsi.com

##########
# Windows Update & Delivery Optimization（建议在主配置里将这些直连）
##########
DOMAIN-SUFFIX,windowsupdate.com
DOMAIN-SUFFIX,update.microsoft.com
DOMAIN,ctldl.windowsupdate.com
DOMAIN,download.windowsupdate.com
DOMAIN-SUFFIX,au.windowsupdate.com
DOMAIN-SUFFIX,displaycatalog.mp.microsoft.com
DOMAIN-SUFFIX,dl.delivery.mp.microsoft.com
DOMAIN-SUFFIX,delivery.mp.microsoft.com
DOMAIN,tlu.dl.delivery.mp.microsoft.com
DOMAIN,tsfe.trafficshaping.dsp.mp.microsoft.com
DOMAIN-SUFFIX,prod.do.dsp.mp.microsoft.com
DOMAIN-SUFFIX,do.dsp.mp.microsoft.com
DOMAIN,adl.windows.com
DOMAIN-SUFFIX,api.cdp.microsoft.com

##########
# Microsoft Store / WNS / Tiles
##########
DOMAIN,storeedgefd.dsx.mp.microsoft.com
DOMAIN,livetileedge.dsx.mp.microsoft.com
DOMAIN-SUFFIX,wns.windows.com
DOMAIN,storecatalogrevocation.storequality.microsoft.com
DOMAIN-SUFFIX,aka.ms

##########
# Microsoft 365 Core（登录 / 门户 / CDN / Graph / 配置）
##########
# 身份与登录
DOMAIN,login.microsoftonline.com
DOMAIN,login.live.com
DOMAIN-SUFFIX,msauth.net
DOMAIN-SUFFIX,msauthimages.net
# 门户与应用
DOMAIN-SUFFIX,office.com
DOMAIN,www.office.com
DOMAIN,officeclient.microsoft.com
DOMAIN-SUFFIX,officeapps.live.com
DOMAIN-SUFFIX,cdn.office.net
DOMAIN-SUFFIX,officecdn.microsoft.com
DOMAIN-SUFFIX,officecdn.microsoft.com.edgesuite.net
# 核心 API / 遥测
DOMAIN,graph.microsoft.com
DOMAIN,self.events.data.microsoft.com
DOMAIN,ecs.nel.measure.office.net
DOMAIN,msedge.api.cdp.microsoft.com
# Substrate / 配置面
DOMAIN,substrate.office.com
DOMAIN,substrate-sdf.office.com
DOMAIN,mss.office.com
# 可能出现的旧入口/兼容
DOMAIN-SUFFIX,windows.net

##########
# Outlook / Exchange（含 Hotmail 及移动端常用入口）
##########
DOMAIN-SUFFIX,outlook.office.com
DOMAIN-SUFFIX,outlook.office365.com
DOMAIN-SUFFIX,outlook.com
DOMAIN-SUFFIX,hotmail.com
DOMAIN,m.hotmail.com
# 常见收发主机（部分客户端仍在用）
DOMAIN,imap-mail.outlook.com
DOMAIN,smtp-mail.outlook.com
DOMAIN,pop-mail.outlook.com

##########
# OneDrive（个人 + 常见依赖；企业版常走 SharePoint）
##########
DOMAIN,onedrive.live.com
DOMAIN-SUFFIX,live.com
DOMAIN,oneclient.sfx.ms
DOMAIN,g.live.com
DOMAIN,logincdn.msauth.net
DOMAIN-SUFFIX,sharepoint.com
DOMAIN-SUFFIX,sharepoint-df.com
# 短链
DOMAIN-SUFFIX,1drv.ms

##########
# Teams / Skype（客户端配置 / 事件 / 静态资源 / 实时通道）
##########
# Teams 常用
DOMAIN-SUFFIX,teams.microsoft.com
DOMAIN,config.teams.microsoft.com
DOMAIN,teams.live.com
DOMAIN,teams.events.data.microsoft.com
DOMAIN,statics.teams.cdn.office.net

# Edge 实验/配置（Teams/Edge 同源服务）
DOMAIN,config.edge.skype.com

# Skype（Consumer）
DOMAIN-SUFFIX,skype.com
DOMAIN,login.skype.com
DOMAIN,api.skype.com
DOMAIN,ui.skype.com
DOMAIN,apps.skype.com
DOMAIN,pipe.skype.com              # Telemetry 管道
# Skype Settings/ASM（含静态与 API）
DOMAIN-SUFFIX,asm.skype.com
DOMAIN,static.asm.skype.com
DOMAIN,as-api.asm.skype.com
# Skype 资源与下载/CDN
DOMAIN-SUFFIX,skypeassets.com
DOMAIN,secure.skypeassets.com
DOMAIN,swx.cdn.skype.com
DOMAIN,download.skype.com
DOMAIN,metrics.skype.com
# 旧 Messenger 网关（聊天/收件）
DOMAIN,client-s.gateway.messenger.live.com
DOMAIN,s.gateway.messenger.live.com
# 实时推送通道（WebSocket / Event Delivery Framework）
DOMAIN-SUFFIX,trouter.skype.com
DOMAIN,go.trouter.skype.com
DOMAIN,go.trouter.io
DOMAIN-SUFFIX,drip.trouter.io

##########
# Xbox / Xbox Live（内容与下载）
##########
DOMAIN-SUFFIX,xboxlive.com
DOMAIN-SUFFIX,xboxservices.com
DOMAIN-SUFFIX,xbox.com
DOMAIN-SUFFIX,assets.xbox.com
DOMAIN-SUFFIX,assets1.xboxlive.com
DOMAIN-SUFFIX,assets2.xboxlive.com
DOMAIN-SUFFIX,dlassets.xboxlive.com
DOMAIN-SUFFIX,dlassets2.xboxlive.com
DOMAIN-SUFFIX,d1.xboxlive.com
DOMAIN-SUFFIX,d2.xboxlive.com
DOMAIN-SUFFIX,xvcb1.xboxlive.com
DOMAIN-SUFFIX,xvcb2.xboxlive.com
DOMAIN-SUFFIX,xvcf1.xboxlive.com
DOMAIN-SUFFIX,xvcf2.xboxlive.com
DOMAIN,xvc-origin.xboxlive.com
DOMAIN,dlassets-ssl.xboxlive.com

##########
# General Microsoft（兜底，放在专用服务之后）
##########
DOMAIN-SUFFIX,microsoft.com
DOMAIN-SUFFIX,windows.com
DOMAIN-SUFFIX,msedge.net
DOMAIN-SUFFIX,msn.com
DOMAIN-SUFFIX,live.net
DOMAIN-SUFFIX,office365.com
DOMAIN-SUFFIX,s-microsoft.com

##########
# ASN fallback（微软自有自治域）
##########
IP-ASN,AS8075,no-resolve
IP-ASN,AS8068,no-resolve
